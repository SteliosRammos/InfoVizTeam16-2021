var color = "darkgrey";

// Generate a 1000 data points using normal distribution with mean=20, deviation=5
var values = [-400, 2021, 891.0,
    2015.0,
    2014.0,
    2013.0,
    2010.0,
    2010.0,
    2009.0,
    2007.0,
    2007.0,
    2006.0,
    2006.0,
    2006.0,
    2003.0,
    2003.0,
    2003.0,
    2001.0,
    2000.0,
    1999.0,
    1999.0,
    1997.0,
    1995.0,
    1994.0,
    1994.0,
    1992.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1990.0,
    1989.0,
    1989.0,
    1988.0,
    1988.0,
    1988.0,
    1988.0,
    1987.0,
    1986.0,
    1986.0,
    1984.0,
    1984.0,
    1984.0,
    1983.0,
    1982.0,
    1981.0,
    1981.0,
    1980.0,
    1980.0,
    1980.0,
    1979.0,
    1979.0,
    1979.0,
    1979.0,
    1978.0,
    1977.0,
    1977.0,
    1976.0,
    1976.0,
    1975.0,
    1975.0,
    1974.0,
    1974.0,
    1973.0,
    1972.0,
    1972.0,
    1972.0,
    1972.0,
    1971.0,
    1971.0,
    1971.0,
    1971.0,
    1971.0,
    1970.0,
    1970.0,
    1970.0,
    1970.0,
    1969.0,
    1969.0,
    1969.0,
    1969.0,
    1969.0,
    1968.0,
    1968.0,
    1968.0,
    1967.0,
    1967.0,
    1967.0,
    1967.0,
    1967.0,
    1966.0,
    1966.0,
    1965.0,
    1965.0,
    1965.0,
    1965.0,
    1964.0,
    1964.0,
    1964.0,
    1963.0,
    1963.0,
    1962.0,
    1960.0,
    1960.0,
    1960.0,
    1959.0,
    1959.0,
    1958.0,
    1958.0,
    1958.0,
    1958.0,
    1958.0,
    1957.0,
    1957.0,
    1956.0,
    1956.0,
    1956.0,
    1956.0,
    1956.0,
    1954.0,
    1954.0,
    1952.0,
    1952.0,
    1951.0,
    1951.0,
    1951.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1950.0,
    1948.0,
    1948.0,
    1947.0,
    1947.0,
    1946.0,
    1945.0,
    1945.0,
    1945.0,
    1944.0,
    1944.0,
    1943.0,
    1943.0,
    1943.0,
    1942.0,
    1941.0,
    1940.0,
    1940.0,
    1940.0,
    1939.0,
    1938.0,
    1937.0,
    1936.0,
    1936.0,
    1936.0,
    1935.0,
    1935.0,
    1935.0,
    1935.0,
    1934.0,
    1934.0,
    1934.0,
    1934.0,
    1934.0,
    1934.0,
    1934.0,
    1933.0,
    1932.0,
    1932.0,
    1932.0,
    1931.0,
    1931.0,
    1931.0,
    1931.0,
    1931.0,
    1931.0,
    1931.0,
    1930.0,
    1930.0,
    1930.0,
    1930.0,
    1929.0,
    1929.0,
    1928.0,
    1928.0,
    1928.0,
    1927.0,
    1927.0,
    1927.0,
    1927.0,
    1927.0,
    1927.0,
    1926.0,
    1926.0,
    1926.0,
    1925.0,
    1925.0,
    1925.0,
    1924.0,
    1924.0,
    1924.0,
    1924.0,
    1924.0,
    1924.0,
    1923.0,
    1923.0,
    1923.0,
    1922.0,
    1922.0,
    1922.0,
    1922.0,
    1922.0,
    1921.0,
    1921.0,
    1921.0,
    1921.0,
    1920.0,
    1920.0,
    1920.0,
    1920.0,
    1920.0,
    1920.0,
    1920.0,
    1919.0,
    1919.0,
    1919.0,
    1919.0,
    1919.0,
    1918.0,
    1918.0,
    1918.0,
    1918.0,
    1917.0,
    1917.0,
    1917.0,
    1917.0,
    1917.0,
    1916.0,
    1916.0,
    1916.0,
    1916.0,
    1916.0,
    1916.0,
    1915.0,
    1915.0,
    1915.0,
    1914.0,
    1914.0,
    1914.0,
    1914.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1913.0,
    1912.0,
    1912.0,
    1912.0,
    1912.0,
    1912.0,
    1912.0,
    1912.0,
    1912.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1911.0,
    1910.0,
    1910.0,
    1910.0,
    1910.0,
    1910.0,
    1910.0,
    1910.0,
    1910.0,
    1910.0,
    1909.0,
    1909.0,
    1909.0,
    1908.0,
    1908.0,
    1908.0,
    1908.0,
    1908.0,
    1908.0,
    1908.0,
    1908.0,
    1908.0,
    1907.0,
    1907.0,
    1907.0,
    1907.0,
    1906.0,
    1906.0,
    1906.0,
    1905.0,
    1905.0,
    1905.0,
    1905.0,
    1904.0,
    1904.0,
    1904.0,
    1904.0,
    1904.0,
    1904.0,
    1903.0,
    1903.0,
    1903.0,
    1902.0,
    1902.0,
    1902.0,
    1902.0,
    1902.0,
    1901.0,
    1901.0,
    1901.0,
    1901.0,
    1900.0,
    1900.0,
    1900.0,
    1899.0,
    1899.0,
    1899.0,
    1899.0,
    1899.0,
    1899.0,
    1899.0,
    1898.0,
    1898.0,
    1898.0,
    1898.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1897.0,
    1896.0,
    1896.0,
    1896.0,
    1896.0,
    1895.0,
    1895.0,
    1895.0,
    1895.0,
    1895.0,
    1895.0,
    1895.0,
    1894.0,
    1894.0,
    1894.0,
    1894.0,
    1894.0,
    1893.0,
    1893.0,
    1893.0,
    1893.0,
    1893.0,
    1893.0,
    1892.0,
    1892.0,
    1892.0,
    1892.0,
    1892.0,
    1891.0,
    1891.0,
    1891.0,
    1891.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1890.0,
    1889.0,
    1889.0,
    1889.0,
    1889.0,
    1889.0,
    1889.0,
    1889.0,
    1889.0,
    1889.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1888.0,
    1887.0,
    1887.0,
    1887.0,
    1887.0,
    1887.0,
    1887.0,
    1886.0,
    1886.0,
    1886.0,
    1886.0,
    1886.0,
    1886.0,
    1886.0,
    1886.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1885.0,
    1884.0,
    1884.0,
    1884.0,
    1884.0,
    1884.0,
    1884.0,
    1884.0,
    1884.0,
    1884.0,
    1883.0,
    1883.0,
    1883.0,
    1883.0,
    1883.0,
    1882.0,
    1882.0,
    1882.0,
    1882.0,
    1882.0,
    1882.0,
    1881.0,
    1881.0,
    1881.0,
    1881.0,
    1881.0,
    1881.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1880.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1879.0,
    1878.0,
    1878.0,
    1878.0,
    1878.0,
    1878.0,
    1877.0,
    1877.0,
    1877.0,
    1877.0,
    1877.0,
    1876.0,
    1876.0,
    1876.0,
    1876.0,
    1876.0,
    1876.0,
    1876.0,
    1875.0,
    1875.0,
    1875.0,
    1875.0,
    1875.0,
    1875.0,
    1875.0,
    1875.0,
    1874.0,
    1874.0,
    1874.0,
    1874.0,
    1874.0,
    1874.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1873.0,
    1872.0,
    1872.0,
    1872.0,
    1871.0,
    1871.0,
    1870.0,
    1870.0,
    1870.0,
    1870.0,
    1870.0,
    1869.0,
    1869.0,
    1869.0,
    1868.0,
    1868.0,
    1868.0,
    1867.0,
    1867.0,
    1866.0,
    1866.0,
    1866.0,
    1866.0,
    1866.0,
    1866.0,
    1865.0,
    1865.0,
    1865.0,
    1865.0,
    1864.0,
    1864.0,
    1863.0,
    1863.0,
    1862.0,
    1862.0,
    1862.0,
    1861.0,
    1860.0,
    1860.0,
    1860.0,
    1860.0,
    1860.0,
    1859.0,
    1857.0,
    1855.0,
    1855.0,
    1854.0,
    1854.0,
    1852.0,
    1852.0,
    1852.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1850.0,
    1849.0,
    1849.0,
    1847.0,
    1847.0,
    1846.0,
    1845.0,
    1845.0,
    1844.0,
    1843.0,
    1843.0,
    1843.0,
    1843.0,
    1842.0,
    1842.0,
    1840.0,
    1838.0,
    1838.0,
    1837.0,
    1836.0,
    1834.0,
    1833.0,
    1833.0,
    1833.0,
    1833.0,
    1832.0,
    1832.0,
    1830.0,
    1830.0,
    1829.0,
    1829.0,
    1828.0,
    1826.0,
    1825.0,
    1825.0,
    1825.0,
    1824.0,
    1823.0,
    1820.0,
    1819.0,
    1819.0,
    1813.0,
    1813.0,
    1811.0,
    1811.0,
    1811.0,
    1811.0,
    1811.0,
    1810.0,
    1805.0,
    1802.0,
    1801.0,
    1800.0,
    1800.0,
    1800.0,
    1800.0,
    1800.0,
    1800.0,
    1800.0,
    1799.0,
    1799.0,
    1798.0,
    1798.0,
    1796.0,
    1793.0,
    1793.0,
    1793.0,
    1791.0,
    1790.0,
    1790.0,
    1790.0,
    1790.0,
    1790.0,
    1790.0,
    1789.0,
    1789.0,
    1789.0,
    1787.0,
    1786.0,
    1786.0,
    1781.0,
    1779.0,
    1778.0,
    1775.0,
    1775.0,
    1773.0,
    1768.0,
    1760.0,
    1759.0,
    1758.0,
    1758.0,
    1757.0,
    1756.0,
    1756.0,
    1756.0,
    1756.0,
    1755.0,
    1755.0,
    1754.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1750.0,
    1748.0,
    1748.0,
    1745.0,
    1743.0,
    1742.0,
    1740.0,
    1738.0,
    1736.0,
    1723.0,
    1720.0,
    1720.0,
    1717.0,
    1714.0,
    1714.0,
    1712.0,
    1712.0,
    1712.0,
    1708.0,
    1708.0,
    1700.0,
    1696.0,
    1691.0,
    1690.0,
    1690.0,
    1690.0,
    1690.0,
    1686.0,
    1685.0,
    1680.0,
    1673.0,
    1669.0,
    1665.0,
    1665.0,
    1663.0,
    1662.0,
    1660.0,
    1657.0,
    1656.0,
    1656.0,
    1654.0,
    1654.0,
    1652.0,
    1651.0,
    1650.0,
    1650.0,
    1650.0,
    1650.0,
    1650.0,
    1650.0,
    1649.0,
    1647.0,
    1644.0,
    1644.0,
    1644.0,
    1644.0,
    1643.0,
    1642.0,
    1642.0,
    1640.0,
    1640.0,
    1638.0,
    1637.0,
    1636.0,
    1636.0,
    1635.0,
    1635.0,
    1635.0,
    1635.0,
    1634.0,
    1630.0,
    1628.0,
    1627.0,
    1625.0,
    1624.0,
    1621.0,
    1618.0,
    1617.0,
    1615.0,
    1615.0,
    1614.0,
    1612.0,
    1609.0,
    1608.0,
    1608.0,
    1608.0,
    1601.0,
    1600.0,
    1592.0,
    1591.0,
    1586.0,
    1584.0,
    1582.0,
    1580.0,
    1577.0,
    1577.0,
    1575.0,
    1575.0,
    1572.0,
    1572.0,
    1567.0,
    1567.0,
    1566.0,
    1566.0,
    1564.0,
    1564.0,
    1564.0,
    1564.0,
    1564.0,
    1563.0,
    1556.0,
    1553.0,
    1552.0,
    1550.0,
    1550.0,
    1550.0,
    1546.0,
    1544.0,
    1542.0,
    1529.0,
    1528.0,
    1527.0,
    1526.0,
    1522.0,
    1520.0,
    1519.0,
    1518.0,
    1518.0,
    1517.0,
    1517.0,
    1516.0,
    1513.0,
    1511.0,
    1511.0,
    1510.0,
    1510.0,
    1510.0,
    1508.0,
    1505.0,
    1505.0,
    1505.0,
    1503.0,
    1503.0,
    1500.0,
    1498.0,
    1498.0,
    1498.0,
    1496.0,
    1495.0,
    1495.0,
    1495.0,
    1494.0,
    1490.0,
    1490.0,
    1490.0,
    1490.0,
    1489.0,
    1486.0,
    1485.0,
    1485.0,
    1485.0,
    1485.0,
    1482.0,
    1481.0,
    1481.0,
    1480.0,
    1480.0,
    1476.0,
    1475.0,
    1470.0,
    1465.0,
    1465.0,
    1464.0,
    1460.0,
    1460.0,
    1460.0,
    1460.0,
    1460.0,
    1453.0,
    1452.0,
    1452.0,
    1451.0,
    1450.0,
    1447.0,
    1429.0,
    1427.0,
    1342.0,
    1336.0,
    1332.0,
    1325.0,
    1325.0,
    1315.0,
    1312.0,
    1306.0,
    1304.0,
    1304.0,
    1297.0,
    1290.0]
    ;

// A formatter for counts.
var formatCount = d3.format(",.0f");

var margin = { top: 20, right: 30, bottom: 30, left: 30 },
    width = 1360 - margin.left - margin.right,
    height = 130 - margin.top - margin.bottom;

var max = d3.max(values);
var min = d3.min(values);
var x = d3.scaleLinear()
    .domain([min, max])
    .range([0, width]);

// Generate a histogram using twenty uniformly-spaced bins.
var data = d3.layout.histogram()
    .bins(x.ticks(120))
    (values);

var yMax = d3.max(data, function (d) { return d.length });
var yMin = d3.min(data, function (d) { return d.length });
var colorScale = d3.scaleLinear()
    .domain([yMin, yMax])
    .range([d3.rgb(color).brighter(), d3.rgb(color).darker()]);

var y = d3.scaleLinear()
    .domain([0, yMax])
    .range([height, 0]);

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var bar = svg.selectAll(".bar")
    .data(data)
    .enter().append("g")
    .attr("class", "bar")
    .attr("transform", function (d) { return "translate(" + x(d.x) + "," + y(d.y) + ")"; });

bar.append("rect")
    .attr("x", 1)
    .attr("width", (x(data[0].dx) - x(0)) - 1)
    .attr("height", function (d) { return height - y(d.y); })
    .attr("fill", function (d) { return colorScale(d.y) });

svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

/*
* Adding refresh method to reload new data
*/
function refresh(values) {
    // var values = d3.range(1000).map(d3.random.normal(20, 5));
    var data = d3.layout.histogram()
        .bins(x.ticks(20))
        (values);

    // Reset y domain using new data
    var yMax = d3.max(data, function (d) { return d.length });
    var yMin = d3.min(data, function (d) { return d.length });
    y.domain([0, yMax]);
    var colorScale = d3.scale.linear()
        .domain([yMin, yMax])
        .range([d3.rgb(color).brighter(), d3.rgb(color).darker()]);

    var bar = svg.selectAll(".bar").data(data);

    // Remove object with data
    bar.exit().remove();

    bar.transition()
        .duration(1000)
        .attr("transform", function (d) { return "translate(" + x(d.x) + "," + y(d.y) + ")"; });

    bar.select("rect")
        .transition()
        .duration(1000)
        .attr("height", function (d) { return height - y(d.y); })
        .attr("fill", function (d) { return colorScale(d.y) });

    bar.select("text")
        .transition()
        .duration(1000)
        .text(function (d) { return formatCount(d.y); });

}

// Calling refresh repeatedly.
// setInterval(function () {
//    var values = d3.range(1000).map(d3.random.normal(20, 5));
//    refresh(values);
//}, 2000);